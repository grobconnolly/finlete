window.cfields=[],window._show_thank_you=function(e,t,a,o){var r=document.getElementById("_form_"+e+"_"),n=r.querySelector("._form-thank-you"),r=(r.querySelector("._form-content").style.display="none",n.innerHTML=t,n.style.display="block","undefined"==typeof visitorGlobalObjectAlias?"vgo":visitorGlobalObjectAlias),t=window[r];o&&void 0!==t?(t("setEmail",o),t("update")):void 0!==a&&a&&_load_script(a),void 0!==window._form_callback&&window._form_callback(e)},window._show_error=function(e,t,a){var e=document.getElementById("_form_"+e+"_"),o=document.createElement("div"),r=e.querySelector("button"),n=e.querySelector("._form_error"),n=(n&&n.parentNode.removeChild(n),o.innerHTML=t,o.className="_error-inner _form_error _no_arrow",document.createElement("div")),t=(n.className="_form-inner",n.appendChild(o),r.parentNode.insertBefore(n,r),e.querySelector('[id^="_form"][id$="_submit"]'));t.disabled=!1,t.classList.remove("processing"),a&&((n=document.createElement("div")).className="_error-html",n.innerHTML=a,o.appendChild(n))},window._load_script=function(e,t,a){var o=document.querySelector("head"),r=document.createElement("script"),n=!1,i=document.querySelector("#_form_5_submit");r.type="text/javascript",r.charset="utf-8",r.src=e,t&&(r.onload=r.onreadystatechange=function(){n||this.readyState&&"complete"!=this.readyState||(n=!0,t())}),r.onerror=function(){a&&(1e4<r.src.length?_show_error("5","Sorry, your submission failed. Please shorten your responses and try again."):_show_error("5","Sorry, your submission failed. Please try again."),i.disabled=!1,i.classList.remove("processing"))},o.appendChild(r)},!function(){if(-1===window.location.search.search("excludeform")){for(var getCookie=function(e){e=document.cookie.match(new RegExp("(^|; )"+e+"=([^;]+)"));return e?e[2]:null},setCookie=function(e,t){var a=new Date,o=a.getTime();a.setTime(o+31536e6),document.cookie=e+"="+t+"; expires="+a+";path=/; Secure; SameSite=Lax;"},addEvent=function(e,t,a){var o;e.addEventListener?e.addEventListener(t,a):(o=e["on"+t],e["on"+t]=function(){o.apply(this,arguments),a.apply(this,arguments)})},_removed=!1,form_to_submit=document.getElementById("_form_5_"),allInputs=form_to_submit.querySelectorAll("input, select, textarea"),tooltips=[],submitted=!1,getUrlParam=function(e){return new URLSearchParams(window.location.search).get(e)||!1},acctDateFormat="%m/%d/%Y",getNormalizedDate=function(e,t){var e=decodeURIComponent(e);return t&&null!==t.match(/(%d|%e).*%m/gi)?e.replace(/(\d{2}).*(\d{2}).*(\d{4})/g,"$3-$2-$1"):!!Date.parse(e)&&(t=new Date(e)).getFullYear()+`-${(e=t.getMonth()+1)<10?"0"+e:e}-`+((e=t.getDate())<10?"0"+e:e)},getNormalizedTime=function(e){var t,e=decodeURIComponent(e),e=Array.from(e.matchAll(/(\d{1,2}):(\d{1,2})\W*([AaPp][Mm])?/gm))[0];return t=e[3]?"pm"===e[3].toLowerCase()?12===parseInt(e[1])?"12":""+(parseInt(e[1])+12):12===parseInt(e[1])?"0":e[1]:e[1],(parseInt(t)<10?"0"+parseInt(t):t)+":"+e[2]},i=0;i<allInputs.length;i++){var regexStr="field\\[(\\d+)\\]",results=new RegExp(regexStr).exec(allInputs[i].name),fieldVal=(allInputs[i].dataset.name=null!=results?allInputs[i].name.match(/\[time\]$/)?window.cfields[results[1]]+"_time":window.cfields[results[1]]:allInputs[i].name,getUrlParam(allInputs[i].dataset.name));fieldVal&&"false"!==allInputs[i].dataset.autofill&&("radio"==allInputs[i].type||"checkbox"==allInputs[i].type?allInputs[i].value==fieldVal&&(allInputs[i].checked=!0):"date"==allInputs[i].type?allInputs[i].value=getNormalizedDate(fieldVal,acctDateFormat):"time"==allInputs[i].type?allInputs[i].value=getNormalizedTime(fieldVal):allInputs[i].value=fieldVal)}var remove_tooltips=function(){for(var e=0;e<tooltips.length;e++)tooltips[e].tip.parentNode.removeChild(tooltips[e].tip);tooltips=[]},remove_tooltip=function(e){for(var t=0;t<tooltips.length;t++)if(tooltips[t].elem===e)return tooltips[t].tip.parentNode.removeChild(tooltips[t].tip),void tooltips.splice(t,1)},create_tooltip=function(e,t){var a=document.createElement("div"),o=document.createElement("div"),r=document.createElement("div"),n={};return"radio"!=e.type&&"checkbox"!=e.type?(a.className="_error",o.className="_error-arrow",r.className="_error-inner",r.innerHTML=t,a.appendChild(o),a.appendChild(r),e.parentNode.appendChild(a)):(a.className="_error-inner _no_arrow",a.innerHTML=t,e.parentNode.insertBefore(a,e),n.no_arrow=!0),n.tip=a,n.elem=e,tooltips.push(n),n},resize_tooltip=function(e){var t=e.elem.getBoundingClientRect(),a=document.documentElement,t=t.top-((window.pageYOffset||a.scrollTop)-(a.clientTop||0));e.tip.className=t<40?e.tip.className.replace(/ ?(_above|_below) ?/g,"")+" _below":e.tip.className.replace(/ ?(_above|_below) ?/g,"")+" _above"},resize_tooltips=function(){if(!_removed)for(var e=0;e<tooltips.length;e++)tooltips[e].no_arrow||resize_tooltip(tooltips[e])},validate_field=function(e,t){var a=null,o=e.value,r=!0;if(t&&remove_tooltip(e),"checkbox"!=e.type&&(e.className=e.className.replace(/ ?_has_error ?/g,"")),null!==e.getAttribute("required"))if("radio"==e.type||"checkbox"==e.type&&/any/.test(e.className)){if(!((i=form_to_submit.elements[e.name])instanceof NodeList||i instanceof HTMLCollection)||i.length<=1)r=e.checked;else for(var r=!1,n=0;n<i.length;n++)i[n].checked&&(r=!0);r||(a=create_tooltip(e,"Please select an option."))}else if("checkbox"==e.type){var i=form_to_submit.elements[e.name],s=!1,l=[];r=!0;for(n=0;n<i.length;n++)if(null!==i[n].getAttribute("required")){if(!s&&i[n]!==e)return!0;s=!0,i[n].className=i[n].className.replace(/ ?_has_error ?/g,""),i[n].checked||(r=!1,i[n].className=i[n].className+" _has_error",l.push("Checking %s is required".replace("%s",i[n].value)))}r||(a=create_tooltip(e,l.join("<br/>")))}else if("SELECT"==e.tagName){var c=!0;if(e.multiple){for(c=!1,n=0;n<e.options.length;n++)if(e.options[n].selected){c=!0;break}}else for(n=0;n<e.options.length;n++)!e.options[n].selected||e.options[n].value&&!e.options[n].value.match(/\n/g)||(c=!1);c||(e.className=e.className+" _has_error",r=!1,a=create_tooltip(e,"Please select an option."))}else null!=o&&""!==o||(e.className=e.className+" _has_error",r=!1,a=create_tooltip(e,"This field is required."));return!r||"field[]"!=e.id&&"ca[11][v]"!=e.id||e.className.includes("phone-input-error")&&(e.className=e.className+" _has_error",r=!1),r&&"email"==e.name&&!o.match(/^[\+_a-z0-9-'&=]+(\.[\+_a-z0-9-']+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,})$/i)&&(e.className=e.className+" _has_error",r=!1,a=create_tooltip(e,"Enter a valid email address.")),r&&/date_field/.test(e.className)&&(o.match(/^\d\d\d\d-\d\d-\d\d$/)||(e.className=e.className+" _has_error",r=!1,a=create_tooltip(e,"Enter a valid date."))),a&&resize_tooltip(a),r},needs_validate=function(e){return null!==e.getAttribute("required")||"email"===e.name&&""!==e.value||!("field[]"!=e.id&&"ca[11][v]"!=e.id||!e.className.includes("phone-input-error"))},validate_form=function(e){form_to_submit.querySelector("._form_error");var t=!0;if(!submitted){submitted=!0;for(var a=0,o=allInputs.length;a<o;a++){var r=allInputs[a];needs_validate(r)&&("tel"==r.type&&addEvent(r,"blur",function(){this.value=this.value.trim(),validate_field(this,!0)}),"text"==r.type||"number"==r.type||"time"==r.type?(addEvent(r,"blur",function(){this.value=this.value.trim(),validate_field(this,!0)}),addEvent(r,"input",function(){validate_field(this,!0)})):"radio"==r.type||"checkbox"==r.type?function(e){for(var t=form_to_submit.elements[e.name],a=0;a<t.length;a++)addEvent(t[a],"click",function(){validate_field(e,!0)})}(r):"SELECT"==r.tagName?addEvent(r,"change",function(){validate_field(this,!0)}):"textarea"==r.type&&addEvent(r,"input",function(){validate_field(this,!0)}))}}remove_tooltips();for(a=0,o=allInputs.length;a<o;a++){var n=allInputs[a];needs_validate(n)&&("select"!==n.tagName.toLowerCase()&&(n.value=n.value.trim()),validate_field(n)||(t=!1))}return!t&&e&&e.preventDefault(),resize_tooltips(),t},hidePhoneInputError=(addEvent(window,"resize",resize_tooltips),addEvent(window,"scroll",resize_tooltips),function(e){var t=document.getElementById("error-msg-"+e),e=document.getElementById(e);t.classList.remove("phone-error"),t.classList.add("phone-error-hidden"),e.classList.remove("phone-input-error")}),initializePhoneInput=function(e,t){return window.intlTelInput(e,{utilsScript:"https://unpkg.com/intl-tel-input@17.0.18/build/js/utils.js",autoHideDialCode:!1,separateDialCode:!0,initialCountry:t,preferredCountries:[]})},setPhoneInputEventListeners=function(t,a,o){a.addEventListener("blur",function(){var e=document.getElementById("error-msg-"+t);a.value.trim()?o.isValidNumber()?(o.setNumber(o.getNumber()),e.classList.contains("phone-error")&&hidePhoneInputError(t)):showPhoneInputError(t):e.classList.contains("phone-error")&&hidePhoneInputError(t)}),a.addEventListener("countrychange",function(){o.setNumber("")}),a.addEventListener("keydown",function(e){var t=e.which||e.keyCode;31<t&&(t<48||57<t)&&8!==t&&e.preventDefault()})},showPhoneInputError=function(e){var t=document.getElementById("error-msg-"+e),e=document.getElementById(e);t.classList.add("phone-error"),t.classList.remove("phone-error-hidden"),e.classList.add("phone-input-error")},_form_serialize=(window.recaptcha_callback=function(){var e,t=document.getElementsByClassName("g-recaptcha");for(e in t){var a,o="recaptcha_"+e,r=(t[e].id=o,document.getElementById(o));null!=r&&(a=r.getAttribute("data-sitekey"),r=r.getAttribute("data-stoken"),grecaptcha.render(o,{sitekey:a,stoken:r}))}},_load_script("https://www.google.com/recaptcha/api.js?onload=recaptcha_callback&render=explicit"),function(e){if(e&&"FORM"===e.nodeName){for(var t,a=[],o=0;o<e.elements.length;o++)if(""!==e.elements[o].name)switch(e.elements[o].nodeName){case"INPUT":switch(e.elements[o].type){case"tel":a.push(e.elements[o].name+"="+encodeURIComponent(e.elements[o].previousSibling.querySelector("div.iti__selected-dial-code").innerText)+encodeURIComponent(" ")+encodeURIComponent(e.elements[o].value));break;case"text":case"number":case"date":case"time":case"hidden":case"password":case"button":case"reset":case"submit":a.push(e.elements[o].name+"="+encodeURIComponent(e.elements[o].value));break;case"checkbox":case"radio":e.elements[o].checked&&a.push(e.elements[o].name+"="+encodeURIComponent(e.elements[o].value))}break;case"TEXTAREA":a.push(e.elements[o].name+"="+encodeURIComponent(e.elements[o].value));break;case"SELECT":switch(e.elements[o].type){case"select-one":a.push(e.elements[o].name+"="+encodeURIComponent(e.elements[o].value));break;case"select-multiple":for(t=0;t<e.elements[o].options.length;t++)e.elements[o].options[t].selected&&a.push(e.elements[o].name+"="+encodeURIComponent(e.elements[o].options[t].value))}break;case"BUTTON":switch(e.elements[o].type){case"reset":case"submit":case"button":a.push(e.elements[o].name+"="+encodeURIComponent(e.elements[o].value))}}return a.join("&")}});const formSupportsPost=!1;var form_submit=function(e){async function submitForm(){var a=new FormData;return new URLSearchParams(serialized).forEach((e,t)=>{a.append(t,e)}),(await fetch("https://finlete.activehosted.com/proc.php?jsonp=true",{headers:{Accept:"application/json"},body:a,method:"POST"})).json()}var submitButton,serialized,err;return e.preventDefault(),validate_form()&&(submitButton=e.target.querySelector("#_form_5_submit"),submitButton.disabled=!0,submitButton.classList.add("processing"),serialized=_form_serialize(document.getElementById("_form_5_")).replace(/%0A/g,"\\n"),err=form_to_submit.querySelector("._form_error"),err&&err.parentNode.removeChild(err),formSupportsPost?submitForm().then(data=>{eval(data.js)}):_load_script("https://finlete.activehosted.com/proc.php?"+serialized+"&jsonp=true",null,!0)),!1};addEvent(form_to_submit,"submit",form_submit)}}();